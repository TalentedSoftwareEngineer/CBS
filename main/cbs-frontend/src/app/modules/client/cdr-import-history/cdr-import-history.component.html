<h4 class="page_title">CDR Import History</h4>
<div class="card">
    <div class="grid">
        <div class="col-12 md:col-3 p-fluid pl-0 pr-0">
          <span class="p-float-label">
            <p-dropdown 
              [options]="serverOptions" 
              [(ngModel)]="selectFilterServer" 
              optionLabel="name" 
              optionValue="value" 
              scrollHeight="150px"
            ></p-dropdown>
            <label>Server</label>
          </span>
        </div>
        <div class="col-12 md:col-3 p-fluid pl-0 pr-0">
          <span class="p-float-label">
            <p-dropdown 
              [options]="statusOptions" 
              [(ngModel)]="selectFilterStatus" 
              optionLabel="name" 
              optionValue="value" 
              scrollHeight="150px"
            ></p-dropdown>
            <label>Status</label>
          </span>
        </div>
        <div class="col-12 md:col-4 pl-0 pr-0">
            <div class="p-inputgroup">
                <input type="text" pInputText placeholder="Keyword..." [(ngModel)]="filterValue" [disabled]="isLoading" (keyup.enter)="onClickFilter()">
                <button type="button" pButton pRipple label="Search" icon="pi pi-search" (click)="isLoading ? '' : onClickFilter()" [style]="isLoading ? {opacity: 0.5} : ''"></button>
            </div>
        </div>
    </div>
</div>

<div class="card">
  <h5><span *ngIf="resultsLength!=-1">Total {{resultsLength}} Record</span><span *ngIf="resultsLength>1">s</span><i *ngIf="resultsLength>0&&filterResultLength>0&&filterResultLength<resultsLength" style="font-size: medium;">, {{filterResultLength}} Record<span *ngIf="filterResultLength>1">s</span> Filtered</i></h5>
  <p-table [value]="imported_cdrs" responsiveLayout="stack" [responsive]="true">
    <ng-template pTemplate="header">
      <tr>
        <th class="text-align-center">
          <a>Server</a>
        </th>
        <th class="text-align-center" [ngClass]="sortActive === 'filename' ? 'sorting_' + sortDirection.toLowerCase() :'sorting'">
          <a (click)="onSortChange('filename')">File Name</a>
        </th>
        <th class="text-align-center" [ngClass]="sortActive === 'status' ? 'sorting_' + sortDirection.toLowerCase() :'sorting'">
          <a (click)="onSortChange('status')">Status</a>
        </th>
        <th class="text-align-center" [ngClass]="sortActive === 'message' ? 'sorting_' + sortDirection.toLowerCase() :'sorting'">
          <a (click)="onSortChange('message')">Message</a>
        </th>
        <th class="text-align-center" [ngClass]="sortActive === 'created_at' ? 'sorting_' + sortDirection.toLowerCase() :'sorting'">
          <a (click)="onSortChange('created_at')">Created At</a>
        </th>
        <th class="text-align-center" [ngClass]="sortActive === 'updated_at' ? 'sorting_' + sortDirection.toLowerCase() :'sorting'">
            <a (click)="onSortChange('updated_at')">Updated At</a>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-importCDR_item>
      <tr>
        <td class="text-align-center">
          <span class="p-column-title">Server</span>
          {{ importCDR_item.server_id}}
        </td>
        <td class="text-align-center">
          <span class="p-column-title">File Name</span>
          {{ importCDR_item.filename }}
        </td>
        <td class="text-align-center">
          <span class="p-column-title">Status</span>
          {{ importCDR_item.status }}
        </td>
        <td class="text-align-center">
          <span class="p-column-title">Message</span>
          {{ importCDR_item.message}}
        </td>
        <td class="text-align-center">
          <span class="p-column-title">Created At</span>
          {{ importCDR_item.created_at }}
        </td>
        <td class="text-align-center">
            <span class="p-column-title">Updated At</span>
            {{ importCDR_item.updated_at }}
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-paginator [rows]="pageSize" [totalRecords]="filterResultLength" [rowsPerPageOptions]="rowsPerPageOptions" (onPageChange)="paginate($event)"></p-paginator>
</div>